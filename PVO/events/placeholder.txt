namespace = djd
character_event = {
	id = djd.1010
	title = EVTT_djd.1010
	desc = EVTDESC_djd.1010
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_job_title = yes
	
	trigger = {
		has_job_action = action_organize_army
		NOT = { has_character_modifier = in_seclusion }
		NOT = { has_character_modifier = bedridden_illness }
		NOT = { trait = incapable }
		liege = {
			any_courtier_or_vassal = {
					character = PREV	
					}
					NAND = {
						martial = 20
						OR = {
							trait = holy_warrior
							trait = siege_leader
							trait = organizer
					}
				}
				NOT = {
					has_character_modifier = drill_cooldown_timer
				}
			}
	}
	
	immediate = {
		liege = {
			random_courtier_or_vassal = {
				limit = {
					character = PREV
					}
					NAND = {
						martial = 20
						OR = {
							trait = holy_warrior
							trait = siege_leader
							trait = organizer
						}
					}
					NOT = {
						has_character_modifier = drill_cooldown_timer
					}
				}
				save_event_target_as = commander_improved
			}
	}
	
	mean_time_to_happen = {
		months = 200
		
		modifier = {
			factor = 1.25
			NOT = { martial = 2 }
		}
		modifier = {
			factor = 1.25
			NOT = { martial = 3 }
		}
		modifier = {
			factor = 1.25
			NOT = { martial = 4 }
		}
		modifier = {
			factor = 1.25
			NOT = { martial = 5 }
		}
		modifier = {
			factor = 0.75
			martial = 10
		}
		modifier = {
			factor = 0.75
			martial = 11
		}
		modifier = {
			factor = 0.75
			martial = 12
		}
		modifier = {
			factor = 0.75
			martial = 13
		}
		modifier = {
			factor = 0.75
			martial = 15
		}
		modifier = {
			factor = 0.75
			martial = 18
		}
	}
	
	option = {
		name =  EVTOPT_djd.1010
		liege = { character_event = { id = djd.1011 } }
	}
}

character_event = {
	id = djd.1011
	title = EVTT_djd.1011
	desc = EVTDESC_djd.1011
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				event_target:commander_improved = {
					NOR = {
						trait = holy_warrior
						trait = siege_leader
						trait = organizer
					}
				}
			}
			event_target:commander_improved = {
				hidden_tooltip = {
					add_character_modifier = {
						name = drill_cooldown_timer
						hidden = yes
						years = 3
					}
				}
				set_character_flag = djd_choose_leadership
			}
		}
	}

	option = {
		name =  EVTOPTA_djd.1011
		prestige = 5
		trigger = {
			NOT = {trait = holy_warrior}
			NOT = {trait = siege_leader}
			NOT = {trait = organizer}
			}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = djd_choose_leadership
				}
			}
			event_target:commander_improved = {
				add_trait = holy_warrior
				clr_character_flag = djd_choose_leadership
			}		
		}
		event_target:commander_improved = {
			random_list = {
				70 = {
					change_martial = 1
				}
				20 = {
					change_martial = 2
				}
				10 = {
					change_martial = 3
				}
			}
		}
	}
		option = {
		name =  EVTOPTB_djd.1011
		prestige = 5
		trigger = {
			NOT = {trait = holy_warrior}
			NOT = {trait = siege_leader}
			NOT = {trait = organizer}
			}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = djd_choose_leadership
				}
			}
			event_target:commander_improved = {
				add_trait = siege_leader
				clr_character_flag = djd_choose_leadership
			}		
		}
		event_target:commander_improved = {
			random_list = {
				70 = {
					change_martial = 1
				}
				20 = {
					change_martial = 2
				}
				10 = {
					change_martial = 3
				}
			}
		}
	}
		option = {
		name =  EVTOPTC_djd.1011
		prestige = 5
			trigger = {
			NOT = {trait = holy_warrior}
			NOT = {trait = siege_leader}
			NOT = {trait = organizer}
			}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = djd_choose_leadership
				}
			}
			event_target:commander_improved = {
				add_trait = organizer
				clr_character_flag = djd_choose_leadership
			}		
		}
		event_target:commander_improved = {
			random_list = {
				70 = {
					change_martial = 1
				}
				20 = {
					change_martial = 2
				}
				10 = {
					change_martial = 3
				}
			}
		}
	}
		option = {
		name =  EVTOPTD_djd.1011
		prestige = 5
		trigger = {
		NOT = {martial = 20}
		}
		clr_character_flag = djd_choose_leadership
		event_target:commander_improved = {
			random_list = {
				50 = {
					change_martial = 2
				}
				30 = {
					change_martial = 3
				}
				20 = {
					change_martial = 5
				}
			}
		}
	}
}